\subsection{LuckyPatcher Detection}\label{subsection:counter-tampering-luckypatcher}

As the example shows, this check is not only a solution to prevent the application from running when LuckyPatcher is present on the device. The screening can be expanded to check for the installation of any other application, like black market apps or other cracking tools as the code example Code Example~\ref{lst: luckycode} shows.

\url{http://stackoverflow.com/questions/13445598/lucky-patcher-how-can-i-protect-from-it}\newline
\url{http://android-onex.blogspot.de/2015/07/anti-piracy-software-activated-solved.html}\newline

\lstinputlisting[
  basicstyle=\footnotesize,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  frame=single,
  numbers=left,
  language=Java,
  linerange={9-69},
  firstnumber=9,
  caption={Partial Listing},
  label={lst: luckycode}
]{data/4-countermeasurements/1-tampering/3-lucky.java}
