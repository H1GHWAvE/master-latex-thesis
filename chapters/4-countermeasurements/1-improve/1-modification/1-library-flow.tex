\subsubsection{Modify the Library} \label{subsection:counter-modifications-library}
\begin{itemize}
    \item test
\end{itemize}
\gls{luckypatcherg}'s patching is reliant on applying its patterns.
Patching application code is the most effective and most common attack to modify the license logic.
Going actively against these patterns should always be the first step to challenge \gls{luckypatcherg}.
This can only be applied to the \gls{lvl} since it is the only library where the source code can be accessed by the developer.
For Amazon and Samsung, this propose can be useful as well but it is more difficult to implement since these two libraries have only one entry and exit point in the applicaiton.
\newline
Modifying and improving the \gls{lvl} does not only protect from patterns.
Increasing complexity of the application's bytecode makes it unqiue and harder to reengineer. \cite{developersSecuring}
\newline
There are three areas the developer should focus on when modifying the \gls{lvl}  \cite{developersSecuring}.
\begin{enumerate}
\item core licensing library logic
\item entry andexit points of the licensing library
\item invocation and handling of the response
\end{enumerate}
The core logic two main classes are the \textit{LicenseChecker} and the \textit{LicenseValidator}.
As seen in section~\ref{section:luckypatcher-patterns}, these two classes are the primary target of \gls{luckypatcherg} and thus should be altered as hard as possible while retaining the original function.
The isomorphic code changes can include:
\begin{itemize}
\item replace the switch statement with an if statement and add additional code between the if statements (see pattern N1)
\item use functions to create new values for constants used and check for these values in the further proceeding (see pattern N3)
\item remove unused code, e.g. implement the \textit{LicenseValidator} online (see patterns N2, N4, N5, N6)
\item move the \gls{lvl} package into the application (see patterns N2,N7)
\item use additional threads to handle different steps in the license verification process
\item implement functions inline where possible (see patterns N2, N5, N7)
\item make actions in the decompiled code difficult to trace by removing functions or moving routines to unrelated code, counter intuitive from traditional software engineering
\item implement radical response handling, e.g. kill the application as soon as a invalid response can be detected, results in bad user experience
\end{itemize}
These are only examples and creativity is welcome since the resulting implementation should be unique. \cite{developersSecuring}
\newline
The entry and exit points can be attacked by creating a counterfeit version of the \gls{lvl} that implements same interface.
An unquite implementation provides resilience against this attack.
It can be achieved by adding additional arguments to the \textit{LicenseChecker} constructor as well as the \textit{allow()} and the \textit{dontAllow()} methods. \cite{developersSecuring}
\newline
Attackers do not only target the \gls{lvl} but the handling of the result in the application as well.
This can be prevented by handling the mechanism in a separate activity.
In the original activity \textit{finish()} will be called and the attacker will be stuck in the new activity.
This prevents from scenarios where the attacker voids methods which would prevent further proceeding.
In addition the license verification can be postponed to a later point in time since attackers are expecting it on the the applications launch. \cite{developersSecuring}
\newline
These modifications are easy to apply and make the implementation unique.
The unlimited ways to implement make it hard to attack automatically.
This does not ensure total protection against \gls{luckypatcherg} since every application is patchable in some way.
A determined attacker, willing to invest a lot of time and work in disassembling and reassembling, can eventually hack the implementation.
The aim of the developer is to make the work of the attacker as hard as possible to the point where the profit is not worth the time. \cite{developersSecuring}
