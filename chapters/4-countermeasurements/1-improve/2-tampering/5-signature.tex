\subsubsection{Signature} \label{subsection:counter-improve-tampering-signature}
Application code is signed to authenticate an application developers and enable them to provide updates for the application \cite{androidSigning}.
Since the signature has to be rewritten when cracking the application, it is an indicator for attacks \cite{tamperSignature}.
\newline
The approach is similar to Google Maps inside an application.
When launching the map, the application sends the SHA1 signature and the API key to the server which verifies whether the application is allowed to display the map \cite{maps}.
\newline
\lstinputlisting[
  float=h,
  basicstyle=\footnotesize,
  breaklines=true,
  captionpos=b,
  frame=single,
  numbers=left,
  language=Java,
  linerange={51-74},
  firstnumber=51,
  caption={Example code for checking the signature of the application},
  label={codeSnippet:tamperingSignature}
]{data/4-countermeasurements/1-tampering/5-signature.java}
The code for the signature check can be seen in code snippet~\ref{codeSnippet:tamperingSignature}.
In order to check the application's signature, the original signature has to be provided (see line 53).
The application's signature fetched from the package information (line 57ff).
In case the signature cannot be retrieved or the signature do not match, the check terminates the application.
