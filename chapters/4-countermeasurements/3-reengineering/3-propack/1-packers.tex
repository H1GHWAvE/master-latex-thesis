\subsubsection{Packers}\label{subsubsection:counter-reengineering-propack-packers}
%START TEXT INPUT
This is my real text! Rest might be copied or not be checked!
%START TEXT INPUT

ERWÄHNEN WO IM PROZESS ANGEWENDET\newline


%
dynamic code loading
best would be an application is transformed by obfuscator that it does not contain any meta information or directly interpretable bytecode, not possible because DVM would not be able to read -see- packing, often used in malware \cite{packerProblemSolution}\newline
packer transforms code that a reverse engineer cannot directly extract information, e.g. by encrypting programm data no information can be extracted without decrypting, would be bad for programm as well that is why packer uses loader stub to decrypt in runtime, soultion decrypt by hand or dynamic analysis\newline
in general two components are created, loader stub and encrypted app, on android the encrypted dex file, easier to create as the loader stub\newline
BILD WIE ER FUNKTIONIERT
step 1 load encrypted app into memory (download from server, extract from data structure, plain file available)
step 2 app file is decrypted -see- original dex, can be any encryption from simple to hard, speed may slow down
step 3 load decrypted dex into DVM from a bytearray, see \cite{schulzLabCourse}
step 4 execute\newline

\cite{schulzLabCourse} stellt hier basic version vor, bessere versionen ist das im folgenden

result: protection makes it hard to analyze the target application, because its bytecode is only available encrypted, decrypted version the unpacking stub has to be analyzed, great slow down, other obfuscations can be applied on stub
%

%
program delivered to end user should be transformed, no direct link between it and original source code, attackers cannot reengineer code and find vulnerability

\cite{munteanLicense}
%
EVALUTAION\newline
soultion decrypt by hand or dynamic analysis\newline
generell: angriff nur nach 2 wenn decrypted, einfach aus memory lesen da es ja iwo hingelegt werden muss um es widerum zu laden, man muss herausfinden wo stub es herläd\newline

ggf auch nur die eine library so laden, aber dazu muss man sie so schreiben, aber auch der cracker muss aufwand betreiben\newline

%

break static analysis tools, you ahve to do runtime analysis\newline
like UPX, stub application unpacks, decrypts, loads into memory which is normally hidden from static analysis\newline
\url{http://www.fortiguard.com/uploads/general/Area41Public.pdf}\newline
\url{https://books.google.de/books?id=ACjUCgAAQBAJ\&pg=PA372\&lpg=PA372\&dq=ijiami+integrity\&source=bl\&ots=NTf7YaqJiZ\&sig=M5GKDCcQB5dcwXR3hjtIv8pMlAA\&hl=de\&sa=X\&ved=0ahUKEwjH3umt1b3JAhXGLA8KHYhwDGsQ6AEIMDAC\#v=onepage\&q=ijiami%20integrity\&f=false}\newline
\url{https://www.blackhat.com/docs/asia-15/materials/asia-15-Park-We-Can-Still-Crack-You-General-Unpacking-Method-For-Android-Packer-No-Root.pdf}\newline
\url{https://www.virusbtn.com/conference/vb2014/abstracts/Yu.xml}\newline
\url{https://www.virusbtn.com/pdf/conference_slides/2014/Yu-VB2014.pdf}\newline
\url{https://www.youtube.com/watch?v=6vFcEJ2jgOw}\newline
\url{https://books.google.de/books?id=ACjUCgAAQBAJ&pg=PA372&lpg=PA372&dq=ijiami+integrity&source=bl&ots=NTf7YaqJiZ&sig=M5GKDCcQB5dcwXR3hjtIv8pMlAA&hl=de&sa=X&ved=0ahUKEwjH3umt1b3JAhXGLA8KHYhwDGsQ6AEIMDAC#v=onepage&q=ijiami%20integrity&f=false}\newline

concept erklären und dann die beispiele nennen, nicht mehr aktiv/gecracked aber prinzip ist gut\newline

examples for packers are
\newline\newline\textbf{\textcolor{gray}{hosedex2jar}}\newline
%START TEXT INPUT
This is my real text! Rest might be copied or not be checked!
%START TEXT INPUT



WER HAT ES HERGESTELLT? WAS IST ES? WAS SIND DIE FEATURES? WIE FUNKTIONIERT ES? WIE WIRD ES IMPLEMENTIERT? WIE SIEHT DAS RESULT AUS (EXAMPLE BILD)\newline

\url{https://youtu.be/6vFcEJ2jgOw?t=1776}\newline
PoC packer\newline
\url{https://github.com/strazzere/dehoser/}\newline
not available for real use\newline
appears defunct\newline
near zero ITW samples\newline
mimics dexception attack from dex education 101\newline
FUNCTION\newline
encrypts and injects dexfile into dex header (deception)\newline
very easy to spot\newline
very easy to decrypt, just use dex2jar\newline
static analysis does not work since it sees the encrypted file\newline
on execution loader stub decrypts in memory and dumps to file system\newline
loader stub acts as proxy and passes events to the dex file on system using a dexClassLoader\newline
RESULT\newline
simple PoC\newline
slight file size increase\newline
attempts to prevent static analysis - kind of works\newline
lots of crashing\newline
easily automated to unpack\newline
easy to reverse, good for learning\newline
hacker protection factor 0.5
\newline\newline\textbf{\textcolor{gray}{Pangxie}}\newline
%START TEXT INPUT
This is my real text! Rest might be copied or not be checked!
%START TEXT INPUT



WER HAT ES HERGESTELLT? WAS IST ES? WAS SIND DIE FEATURES? WIE FUNKTIONIERT ES? WIE WIRD ES IMPLEMENTIERT? WIE SIEHT DAS RESULT AUS (EXAMPLE BILD)\newline

\url{https://youtu.be/6vFcEJ2jgOw?t=1982}\newline
anti-debug\newline
anti-tamper\newline
appears to be defunct product\newline
little usage/samples ITW\newline
FUNCTION\newline
\url{https://youtu.be/6vFcEJ2jgOw?t=2040}\newline
encrypts dex file and bundles as asset in APK\newline
very easy to find, logcat has to much information\newline
dalvik calls JNI layer to verify and decrypt\newline
easy to reverse, both dalvik and native, excellent for beginners to Android and packers\newline
aes used only for digest verification\newline
easily automated, 0x54 always the key\newline
or dynamically grab app\_dex folder\newline
slightly increase file size\newline
prevents static analysis - though easy to identify\newline
uses static 1 byte key for encryption\newline
easily automated to unpack\newline
very easy to reverse, good for learning\newline
good example of an unobfuscated packer stub for cloning\newline
hacker protection faktor 1.5\newline
only working till <4.4\newline
simple packer, increase encryption with key, do not just dump on filesystem
\newline\newline\textbf{\textcolor{gray}{BANGCLE}}\newline
%START TEXT INPUT
This is my real text! Rest might be copied or not be checked!
%START TEXT INPUT



WER HAT ES HERGESTELLT? WAS IST ES? WAS SIND DIE FEATURES? WIE FUNKTIONIERT ES? WIE WIRD ES IMPLEMENTIERT? WIE SIEHT DAS RESULT AUS (EXAMPLE BILD)\newline

anti-debugging\newline
anti-tamper\newline
anti-decompilation\newline
anti-runtime injection\newline
online only service, apk checked for malware\newline
detected by some anti virus due to malware\newline
cost 10k\newline
no one has done it before...\newline
stopped working on 4.4\newline
FUNCTION\newline
dalvik execution talks launched JNI\newline
JNI launches secondary process\newline
chatter over PTRACE between the two processes\newline
newest process decrypts dex into memory\newline
original dalvik code proxies everything to the decrypted dex\newline
RESULT\newline
well written, lots of anti-* tricks\newline
seems to be well supported and active on development\newline
does a decent job on online screening - no tool released for download (though things clearly to slip through)\newline
not impossible to reverse and re-bundle packages\newline
current weakness (for easy runtime unpacking) is having a predictable unpacked memory location\newline
hacker protect faktor 5\newline
probably best tool out there but lag when updating since online approval\newline
