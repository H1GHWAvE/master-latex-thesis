\section{Blackbox Analysis of Patched Applications} \label{section:luckypatcher-operation}
The blackbox approach is done to identify the parts of the code manipulated by \gls{luckypatcherg} and to suggest solutions to protect these weak points.
Different applications are used to get a variety of results and see how the different implementations are attacked.
\newline
The applications are patched using the \textit{Auto Modes}.
The approach for creating a modified \gls{apk} was chosen since \gls{odex} files are device specific and cannot be used for a general conclusion of an attack.
The outcome is analysed using the methodologies described in  section~\ref{section:reengineering}.
Since the only the bytecode is modified, a static analysis is sufficient.
\newline
The goal of reverse engineering the code and comparing it to the original application is to discover the changes and analyse them on different abstraction levels.
This includes the \gls{dex} level, on which Lucky Patcher works, the smali level, which makes the \gls{dex} code human readable, as well as Java level, on which the functionality change can be identified.
On each level, the modified and original code are compared using diff to retrieve the changes in an easy way as well as ignoring the unchanged code.
\newline
\newline
Besides circumventing the Google \gls{lvl}, \gls{luckypatcherg} supports the the removing of Amazon's and Samsung's license verification library.
A reference application with known source code and an implementation, according to the tutorial of \gls{lvl} \cite{developersLicensingAdding}, is created.
This application is called \textit{LicenseTest}.
It gives full control and knowledge of the code and allows the analyse of \gls{luckypatcherg} attack on the most basic version.
The same application is uploaded with deactivated \gls{lvl} to the Amazon store and injected with the \textit{Kiwi} \gls{drm}.
The analysis for Samsung’s Zirconia \gls{drm} is only done by using \textit{LicenseTest} with deactivated \gls{lvl} as well, since the library is implemented the same way into all applications.
This can be assumed since the library is included as a \gls{jar} and cannot be modified.
In addition to the basic application, other applications were analysed as well,to see how \gls{luckypatcherg} handles different implementations.
The applications, are Runtastic Pro\cite{runtasticApp}, version 6.3, and Teamspeak 3\cite{teamspeakApp}, version 3.0.20.2, for the \gls{lvl} and A Better Camera \cite{abettercamera}, version 3.35, for the Amazon DRM.
These apps were chosen since they were already owned and approved to be included into the thesis by the developers.
They include Google’s \gls{lvl} and Amazon \gls{drm}.
\newline
In addition to the code analysis, the modified application is installed on different devices to evaluate the success of the crack.
This is possible since the modified application can be installed on any device.
The goal is to identify whether the crack works even though the corresponding store, root or internet connection are not available.
\newline
As described before, \gls{luckypatcherg} offers different modes to patch applications.
Each mode uses a set of patterns which each change a piece of binary.
These patterns are shown in figure~\ref{fig:luckyScreen} on the right.
A pattern is a set of predefined sequences of bytecode in which a certain values are modified.
In order to discover applied patterns and to evaluate each mode, each mode is applied on each application.
\newline
These are the different modes and what Lucky Patcher describes them as.
\begin{itemize}
\item The Auto Mode - "The minimal number of patches. Suitable for most applications with simple protection".
\item Auto Mode (Inversed) "There are a few differences from the ”Auto mode”. It may help you, if ”Auto mode” was unsuccessful."
\item Other Patches (Extreme Mode!) - "Additional patches (may cause instability). Apply only if the other patterns were unsuccessful. Requires internet. Try to use together with ”Auto mode” or ”Auto mode (Inversed)”."
\item Auto Mode (Amazon Market) - "Removes License Verification for applications from Amazon Market"
\item Auto Mode (SamsungApps) - "Removes License Verification for Apps from SamsungApps" (Note: SamsungApps is called GalaxyApps, see subsection~\ref{section:license-samsung})
\end{itemize}
