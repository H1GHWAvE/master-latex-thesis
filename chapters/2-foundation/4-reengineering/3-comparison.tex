\subsection{Pinpointing the Attack} \label{subsection:forensics-tools-diff}
The amount of code on each abstraction levels is quite substantial.
In a code altering attack, most of the code stays the same, i.e. changes are only punctually.
Diff, a standard command line tool, is used to compare two sources with little differences.
\newline
By comparing the different code abstractions of the original \gls{apk} with the cracked application, changes done by \gls{luckypatcherg} are identified.
Diff is used in a script to generate the result for different applications and abstraction levels at once (see code snippet~\ref{codeSnippet:diffScript}).
Doing this automatically and using diff saves a lot of time.
\newline
\lstinputlisting[
  float=h,
  breaklines=true,
  captionpos=b,
  frame=single,
  numbers=left,
  language=bash,
  linerange={1-9},
  firstnumber=1,
  caption={Script to compare the original and manipulated \gls{apk} using diff},
  label={codeSnippet:diffScript}
]{data/diffScript.sh}
\newline
The result does not only contain the change as original and new code, but also the location where the change happened.
The example diff of a dex file is presented is code snippet~\ref{codeSnippet:diffDex}.
\newline
\lstinputlisting[
  style=diff,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  frame=single,
  linerange={20-21},
  caption={Example of diff for dex code},
  label={codeSnippet:diffDex}
]{data/n3.diff}
