\subsubsection{Implementation of Kiwi} \label{section:license-amazon-implementation}
\begin{itemize}
    \item wrapper injected by amazon
    \item same logic in every app
    \item reengineering shows that it replaces the onCreate, called first then the original one
    \item library code is obfuscated
    \item logic does not interweave with app logic since injection is wrapped around, else would need developer
\end{itemize}
\lstinputlisting[
  float=h,
  basicstyle=\footnotesize,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  frame=single,
  numbers=left,
  language=Java,
  linerange={77-80},
  firstnumber=77,
  caption={Amazon's onCreate() injection to call Kiwi license verification as well},
  label={codeSnippet:amazonCreate}
]{data/amazon.java}
